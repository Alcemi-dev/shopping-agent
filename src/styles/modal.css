/* ---- Knobs (mobile defaults) ---- */
:root {
  /* spacing */
  --gutter: 1.75rem; /* 28px */

  /* keyboard dock spacing */
  --dock-gap-closed: var(--gutter);
  --dock-gap-open: 1rem; /* 16px */

  /* measured by JS; fallback */
  --dock-h: 7rem; /* 112px */

  /* desktop geometry knobs (naudojami tik @media ≥481px) */
  --edge-min: 1.5rem; /* 24px */
  --edge-max: 4rem; /* 64px */
  --edge: clamp(var(--edge-min), 6vw, var(--edge-max));
  --modal-w-desktop: 83.125rem; /* 1330px */
  --modal-h-desktop: 48.75rem; /* 780px */
}

/* ================= Root & Backdrop (DIALOG) ================= */

/* resetinam UA <dialog> stilius */
.modal-root {
  padding: 0;
  margin: 0;
  border: none;
  background: transparent;
}

/* uždarytas dialogas nerodomas */
.modal-root:not([open]) {
  display: none;
}

/* atidarytas dialogas dengia visą viewport */
.modal-root[open] {
  position: fixed;
  inset: 0;
  width: 100vw;
  height: 100svh;
  max-width: none;
  max-height: none;
  z-index: var(--z-modal);
  pointer-events: auto;
}
@supports (height: 100dvh) {
  .modal-root[open] {
    height: 100dvh;
  }
}

/* natyvus backdrop iš <dialog> */
.modal-root::backdrop {
  background: var(--backdrop);
  opacity: 1; /* animacijų kol kas nedarom */
}

/* ================= Card (mobile base: fullscreen) ================= */
.modal-card {
  position: fixed;
  inset: 0;
  width: 100vw;
  height: 100svh; /* fallback */
  border: none;
  border-radius: 0;
  display: flex;
  overflow: hidden;
  color: var(--text-on-dark);
  background: var(--surface-modal) url("/img/background-gradient-mobile.svg") center / cover no-repeat;
}
@supports (height: 100dvh) {
  .modal-card {
    height: 100dvh;
  }
}

/* ================= Inner container ================= */
.modal-ctr {
  position: relative;
  z-index: 1;
  display: flex;
  flex-direction: column;
  padding-bottom: 0;
  width: 100%;
  height: 100%;
  min-height: 0; /* allow inner scroll on children */
}

/* ================= Header (mobile) ================= */
.modal-head {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  min-height: 1.5rem; /* 24px */
  padding: 1rem var(--gutter); /* 16px x gutter */
  position: relative;
}
.icon-btn {
  appearance: none;
  border: none;
  background: transparent;
  padding: 0.5rem; /* 8px */
  margin: 0;
  width: 2.5rem; /* 40px */
  height: 2.5rem; /* 40px */
  display: inline-grid;
  place-items: center;
  cursor: pointer;
  color: #fff;
  transition: opacity 0.12s ease, transform 0.12s ease;
}
.icon-btn img {
  width: 1rem; /* 16px */
  height: 1rem;
  display: block;
}
.icon-btn:hover {
  opacity: 0.9;
}
.icon-btn:focus-visible {
  outline: 2px solid #8ab4ff;
  outline-offset: 2px;
}
.head-logo-mobile {
  display: inline-block;
  background: transparent;
  border: 0;
  padding: 0;
}
.head-logo-mobile img {
  height: 1.5rem;
  width: auto;
  display: block;
}
.head-back {
  display: none;
}
.head-spacer {
  flex: 1 1 auto;
}

/* ================= Title ================= */
.modal-title {
  margin: 0;
  text-align: center;
  font-family: var(--font-sans, "Satoshi", system-ui, -apple-system, Segoe UI, Roboto, sans-serif);
  font-weight: 400;
  font-size: 1.75rem; /* 28px mobile */
  line-height: 1.2;
  color: var(--text-on-dark);
}
.break--desktop {
  display: none;
}
.break--mobile {
  display: inline;
}

/* ================= Column & Body (mobile) ================= */
.modal-col {
  width: 100%;
  max-width: none;
  min-height: 0;
  margin: clamp(3rem, 26dvh, 15.625rem) auto 0; /* 48px..250px */
  gap: 1.75rem; /* 28px */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  overflow: visible;
  padding: 0;
}

.modal-body {
  width: 100%;
  max-width: none;
  margin: 0;
  display: flex;
  flex-direction: column;
  gap: 1rem; /* 16px */
  overflow-y: auto;
  overflow-x: hidden;
  min-height: 0;
  height: 100%;
  padding: 0 0 calc(0.75rem + var(--dock-h) + var(--dock-gap-closed) + var(--safe-bottom));
}

/* Chips — horizontal mobile rail (vizualas — styles/chips.css) */
.suggestions {
  margin: 0;
  padding-block: 0.375rem; /* 6px */
}
.suggestions::-webkit-scrollbar {
  display: none;
}
.suggestions > * {
  flex: 0 0 auto;
}

/* Input dock pinned to visible viewport bottom (mobile) */
.input-dock {
  position: fixed;
  left: 0;
  right: 0;
  bottom: var(--safe-bottom);
  z-index: 3;
  margin: 0;
  display: flex;
  justify-content: center;
  pointer-events: none;
  padding: 0 var(--gutter) var(--dock-gap-closed);
  background: none;
}
.input-dock .input-wrap {
  pointer-events: auto;
}

/* Answer mode (mobile) */
.modal-col.is-answer {
  margin: 0 auto;
  gap: 0;
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}
.modal-col.is-answer .modal-body {
  width: 100%;
  display: flex;
  justify-content: center;
  padding: 0 0 calc(0.75rem + var(--dock-h) + var(--dock-gap-closed) + var(--safe-bottom));
}

.answer-center {
  width: 100%;
  display: flex;
  justify-content: center;
}
.answer-bubble {
  background: rgba(255, 255, 255, 0.08);
  color: #e7e9f2;
  border-radius: var(--radius-md);
  padding: 0.75rem 0.875rem; /* 12px 14px */
  border: 1px solid rgba(255, 255, 255, 0.18);
  max-width: min(35rem, 90%); /* 560px */
  margin-bottom: calc(0.75rem + var(--dock-h) + var(--dock-gap-closed));
}

/* Footer (hidden on mobile) */
.modal-footer {
  display: none;
}
.powered-by {
  height: 1.5625rem; /* 25px */
  width: 3.8125rem; /* 61px */
  opacity: 0.9;
  display: block;
}

/* ===== Keyboard-open overrides (mobile) ===== */
html.kb-open .modal-root[open] .modal-head {
  padding: 0.375rem var(--gutter) 0.25rem !important; /* 6px  g  4px */
}
html.kb-open .modal-root[open] .modal-ctr .modal-col {
  margin: 1.25rem auto 0 !important; /* 20px nuo viršaus */
  gap: 1.125rem !important; /* 18px */
}
html.kb-open .modal-root[open] .suggestions {
  padding-block: 0.25rem !important; /* 4px */
  margin-top: 0.375rem !important; /* 6px */
}
html.kb-open .modal-root[open] .input-dock {
  padding-bottom: calc(var(--dock-gap-open) + var(--safe-bottom)) !important;
}
html.kb-open .modal-root[open] .modal-body {
  padding-bottom: calc(0.75rem + var(--dock-h) + var(--dock-gap-open) + var(--safe-bottom)) !important;
}
html.kb-open .modal-root[open] .answer-bubble {
  margin-bottom: calc(0.75rem + var(--dock-h) + var(--dock-gap-open) + var(--safe-bottom)) !important;
}

/* Respect reduced motion (mobile scope) */
@media (prefers-reduced-motion: reduce) {
  .modal-root[open] .modal-ctr .modal-col,
  .modal-root[open] .modal-head,
  .modal-root[open] .suggestions,
  .modal-root[open] .input-dock,
  .modal-root[open] .modal-body,
  .modal-root[open] .modal-title {
    transition: none !important;
  }
}

/* =========================================================
   DESKTOP overrides (≥481px)
   ========================================================= */
@media (min-width: 481px) {
  .modal-root[open] {
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .modal-card {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    width: clamp(32.5rem, calc(100vw - 2 * var(--edge)), var(--modal-w-desktop));
    max-height: var(--modal-max-h);
    height: min(var(--modal-h-desktop), var(--modal-max-h));
    border: 1px solid var(--outline);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-elev-1);
    background: var(--surface-modal) url("/img/background-gradient-desktop.svg") center / cover no-repeat;
  }

  .modal-ctr {
    align-items: stretch;
    padding: 0.3125rem 0; /* 5px vert – minimalus */
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
  }

  .modal-head {
    padding: 1.125rem 1.5rem;
  } /* 18px 24px */
  .head-back {
    display: inline-grid !important;
  }
  .modal-head .head-logo-mobile {
    display: none !important;
  }

  .modal-title {
    font-size: 1.875rem;
  } /* 30px */
  .break--desktop {
    display: inline;
  }
  .break--mobile {
    display: none;
  }

  .modal-col {
    width: 100%;
    max-width: 30rem; /* 480px */
    margin: 8.75rem auto 0; /* 140px from top */
    gap: 3rem; /* 48px */
    align-items: stretch;
  }

  .modal-body {
    max-width: 44rem;
    display: flex;
    margin: 0 auto;
    flex-direction: column;
    align-items: center;
    gap: 1.25rem; /* 20px */
    padding: 0;
    overflow: visible;
  }

  /* Chips centre (vizualas – chips.css) */
  .suggestions {
    max-width: 30rem; /* ~480px “rails” */
    margin: 0 auto;
    padding: 0;
  }
  .suggestions .chips-inline {
    display: flex;
    flex-wrap: wrap; /* laužom į kelias eilutes */
    justify-content: center;
    gap: 1rem;
    overflow: visible; /* be horiz. scroll */
    padding: 0;
    scrollbar-width: auto;
  }
  .suggestions .chips-inline::-webkit-scrollbar {
    display: initial;
  }

  /* Dock – absolute virš footerio */
  .input-dock {
    position: absolute;
    left: 0;
    right: 0;
    bottom: 3.5rem; /* 56px */
    display: flex;
    justify-content: center;
    z-index: 2;
    pointer-events: none;
    padding: 0; /* jokių papildomų gap */
  }
  .input-dock .input-wrap {
    pointer-events: auto;
  }

  /* Answer mode */
  .modal-col.is-answer {
    margin: 0 auto;
    gap: 0;
    flex: 1 1 auto;
    justify-content: center;
    align-items: center;
  }
  .modal-col.is-answer .modal-body {
    width: 100%;
    justify-content: center;
    padding: 0;
  }

  /* Footer visible desktop */
  .modal-footer {
    position: absolute;
    left: 1.375rem; /* 22px */
    bottom: 1.125rem; /* 18px */
    background: transparent;
    padding: 0;
    display: flex;
    align-items: center;
  }
}

/* ================= Global reduced motion ================= */
@media (prefers-reduced-motion: reduce) {
  .modal-root::backdrop {
    transition: none !important;
  }
}

/* Fallback (senesnėms naršyklėms be height:min()) */
@supports not (height: min(1px, 2px)) {
  @media (min-width: 481px) {
    .modal-card {
      height: auto;
      max-height: var(--modal-max-h);
    }
  }
}
